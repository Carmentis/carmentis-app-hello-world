/**
  Licensed under the Apache License, Version 2.0
  (c)2022-2024 Carmentis SAS
  Built 2024-09-16T10:21:57.323Z
*/
var CarmentisApp=function(e){"use strict";const t=Carmentis.core.storage.fileSystem,a=Carmentis.core.util.textEncoder;let n,c,r=t.directory("WALLET");function i(e){c=e}async function s(e){let t=await r.byUid(n,e).read();return await c.decrypt(t)}async function o(e,t){let a=await c.encrypt(t);return await r.byUid(n,e).write(a)}async function p(e){return await r.byUid(n,e).del()}const l=Carmentis.core.constants,u=Carmentis.web.dom,d=Carmentis.core.util.helpers,m="0.2",_=12;let f,b,y,h;async function w(e){f=e,n="walletFile"+e,u.get("#_app_user").find("span").text(" "+String.fromCharCode(65+e))}async function v(){b={seed:null,accounts:[],currentAccount:0},M(null,u.create("div","_app_splash").append(u.create("div").text("version "+m)));let e=await async function(){return await r.byUid(n,"seed").exists()}()?g:k;setTimeout(e,1500)}function g(){M(null,X("Enter your password"),u.create("p").className("_app_center").text("Please enter your password to unlock your wallet."),u.create("input","_app_pwd").setAttribute("type","password").event("input",(e=>u.get("#_app_error").style({visibility:"hidden"}))),u.create("p","_app_error").className("_app_center _app_error").text("invalid password").style({visibility:"hidden"}),u.create("button").text("Submit").click((async function(){let e=u.get("#_app_pwd").el.value;i(await Carmentis.deriveAesKeyFromPassword(e));let t=await s("seed");!1===t?u.get("#_app_error").style({visibility:"visible"}):(await async function(){b.accounts=await async function(){let e=await s("accounts");return JSON.parse(a.decode(e))}()}(),b.seed=t,T())})))}function k(){function e(){let e=u.get("#_app_pwd1").el.value,t=u.get("#_app_pwd2").el.value,a=u.get("#_app_agree").el.checked;u.get("#_app_ok").disabled(""==e||t!=e||!a)}M(null,X("Choose a password"),u.create("p").className("_app_center").text("Choose a password to protect your wallet."),u.create("input","_app_pwd1").setAttribute("type","password").event("input",e),u.create("p").className("_app_center _app_mt16").text("Confirm your password."),u.create("input","_app_pwd2").setAttribute("type","password").event("input",e),q("_app_agree",'I understand that Carmentis cannot help me recover my password (<a href="#" id="_app_learn">learn more</a>).',e),u.create("button","_app_ok").text("Submit").click((async function(){let e=u.get("#_app_pwd1").el.value;i(await Carmentis.deriveAesKeyFromPassword(e)),M(null,X("Private key"),u.create("p").text("No private key is currently stored in your wallet."),u.create("p").text("You may either create a new key or import an existing one."),u.create("button").text("Create").click(x),u.create("button").text("Import").click(N))})).disabled(!0)),u.get("#_app_learn").click(B)}async function x(){b.wordList=await Carmentis.generateWordList(_),C(A,!1,!0)}function C(e,t,a){M(null,X("Your passphrase"),u.create("p").text("Store your passphrase securely in different locations. Never share it with anyone."),u.create("table").className("_app_passphrase_table").append(...[...Array(_/3).keys()].map((e=>u.create("tr").append(...[0,1,2].map((t=>u.create("td").text(b.wordList[3*e+t]))))))),u.create("p").className("_app_center _app_mt16").append(u.create("a").setAttribute("href","#").html('<i class="bi bi-copy"></i> Copy the passphrase').click((e=>{e.preventDefault(),navigator.clipboard.writeText(b.wordList.join(" "))}))),...a?[q(null,'I understand that Carmentis cannot help me recover my passphrase (<a href="#" id="_app_learn">learn more</a>).',(e=>u.get("#_app_ok").disabled(!e)),t)]:[u.create("p").html('Remainder: Carmentis cannot help you recover your passphrase (<a href="#" id="_app_learn">learn more</a>).')],u.create("button","_app_ok").text("OK").click(e).disabled(!t)),u.get("#_app_learn").click(B)}async function A(){let e=[...Array(_).keys()];for(let t=_;--t;){let a=Math.random()*(t+1)|0;[e[t],e[a]]=[e[a],e[t]]}function t(){u.get("#_app_ok").disabled(e.some((e=>u.get("#_app_w"+e).el.value.trim().toLowerCase()!=b.wordList[e])))}e=e.slice(0,3),M(null,X("Confirm your passphrase"),u.create("p").className("_app_center").text("Please fill in the missing words."),u.create("table").className("_app_passphrase_table").append(...[...Array(_/3).keys()].map((a=>u.create("tr").append(...[0,1,2].map((n=>{let c=u.create("td"),r=3*a+n;return e.includes(r)?c.append(u.create("input","_app_w"+r).className("_app_missing_word").setAttribute("maxlength",8).event("input",t)):c.text(b.wordList[r]),c})))))),u.create("button","_app_ok").text("OK").click((async function(){await D(b.wordList)&&T()})).disabled(!0),u.create("p").className("_app_center _app_mt16").append(u.create("a").setAttribute("href","#").html('<i class="bi bi-eye"></i> Show the passphrase again').click((e=>{e.preventDefault(),C(A,!0,!0)}))))}function N(){M(null,X("Your passphrase"),u.create("p").className("_app_center").text("Please enter your passphrase below."),u.create("textarea","_app_data").style({height:"110px"}),u.create("button").text("OK").click((async function(){let e=u.get("#_app_data").el.value.trim().split(/\s+/);await D(e)&&T()})))}async function D(e){try{let t=await Carmentis.getSeedFromWordList(e);return await o("seed",t),b.seed=t,!0}catch(e){return!1}}function T(){if(!b.accounts.length)return void P(0);const e=[["Scan","qr-code-scan",U],["Accounts","person",F],["Parameters","gear",j]];M(null,X("Welcome"),u.create("p").className("_app_center").text(`Account #${b.currentAccount+1} - ${b.accounts[b.currentAccount].name}`),u.create("div","_app_menu").append(...e.map((([e,t,a])=>u.create("div").className("_app_menu_item").append(u.create("div").append(V(t)),u.create("div").text(e)).click(a)))))}async function S(e){let t=Q(e),a=await G(e);M(F,X("Account #"+(e+1)),J("Account name"),u.create("p").className("_app_m12").text(t.name),J("Public account key"),ee(a),te(a),u.create("button").text("Modify the account name").click((t=>P(e,(t=>S(e))))),u.create("button").text("Your personal data").click((t=>R(e))),u.create("button").text("Show private keys").click((t=>async function(e){b.accounts[e];let t=await Carmentis.derivePepperFromSeed(b.seed,e+1),a=await Carmentis.deriveOrganizationPrivateKey(t),n=await Carmentis.deriveNodePrivateKey(t);M((t=>S(e)),X("Account #"+(e+1)),J("Private organization key"),ee(a),te(a),J("Private node key"),ee(n),te(n),u.create("button").text("Close").click((t=>S(e))))}(e))),u.create("button").text("Close").click(F))}function P(e,t){let a=Q(e);M(t,X("Account #"+(e+1)),u.create("p").className("_app_center").text("Enter a name to identify your account."),u.create("input","_app_name").className("_app_center").value(a.name),u.create("button").text("Confirm").click((async function(){a.name=z("name"),await H(),(t||T)()})))}function R(e){let t=Q(e),a=t.userData.email&&!t.userData.emailProof;if(M((t=>S(e)),X("Account #"+(e+1))),[["firstname","Firstname"],["lastname","Lastname"],["email","Email"]].forEach((([e,a])=>{W(J(a),u.create("p").className("_app_m12").text(t.userData[e]||"(not specified)"))})),t.userData.emailProof){let e=new Date(1e3*t.userData.emailProof.ts),a=e.toLocaleDateString("en-US"),n=e.toLocaleTimeString("en-US",{hour:"numeric",minute:"numeric"});W(u.create("p").className("_app_m12 _app_success").style({marginTop:"-10px"}).html(`<i class="bi bi-check-circle-fill"></i> <span style="font-weight:bold">verified</span> on ${a}, at ${n}`))}a&&W(u.create("button").className("_app_mt16").text("Verify your email").click((t=>L(e)))),W(u.create("button").className(a?"":"_app_mt16").text("Edit").click((t=>function(e){let t=Q(e),a=t.userData.email;M((t=>R(e)),X("Account #"+(e+1)),u.create("label").text("Firstname"),u.create("input","_app_firstname").value(t.userData.firstname),u.create("label").text("Lastname"),u.create("input","_app_lastname").value(t.userData.lastname),u.create("label").text("Email"),u.create("input","_app_email").value(t.userData.email),u.create("button").className("_app_mt16").text("Confirm").click((async function(){t.userData.firstname=z("firstname"),t.userData.lastname=z("lastname"),t.userData.email=z("email"),t.userData.email!=a&&delete t.userData.emailProof,await H(),R(e)})))}(e))),u.create("button").text("Close").click((t=>S(e))))}async function L(e,t=!0){let a=Q(e);if(t){ce();let t=await G(e),n=await Carmentis.dataServerQuery("email-validator/initialize",{email:a.userData.email,publicKey:ae(t)});b.otpToken=n.data.token,await re()}M((t=>R(e)),X("Email verification"),u.create("p").text("A 6-digit verification code has been sent to your email address. Please enter this code below."),u.create("input","_app_otp").className("_app_otp").setAttribute("maxlength",6),u.create("button").className("_app_mt16").text("Confirm").click((async function(){let t=await Carmentis.dataServerQuery("email-validator/answer",{token:b.otpToken,value:z("otp")});t.success?(a.userData.emailProof=t.data.proof,await H(),function(e=T){M(null,u.create("div").className("_app_notif_icon _app_success_bg").append(V("check-lg"))),setTimeout(e,1e3)}((t=>R(e)))):ne((t=>L(e,!1)))})))}function U(){M(T,X("Scan the QR code"),u.create("div").className("_app_scan").append(u.create("div").className("_app_scan_top_left"),u.create("div").className("_app_scan_top_right"),u.create("div").className("_app_scan_bottom_left"),u.create("div").className("_app_scan_bottom_right")),u.create("div").className("_app_qr")),setTimeout((e=>{let t=u.get("#qr"),a=t.find("img");u.get("._app_qr").append(u.create("img").setAttribute("src",a.getAttribute("src"))),setTimeout((async e=>{let a=t.getAttribute("data-code");await async function(){return new Promise((function(e,t){let a=new Audio("assets/debug-app/audio/success.ogg");a.addEventListener("ended",(t=>{e()})),a.play()}))}(),await async function(e){let t=await Carmentis.wallet.getRequestByQRCode(e);t?async function(e){console.log("confirmDevice",e);let t=await Carmentis.dataServerQuery("geolocation/query",{ip:e.ip});if(!t.success)return ne(),!1;let a=t.data.geo,n=[["Country",l.COUNTRY.country[a.countryCode]],["City",a.city],["ASN",a.org.match(/^\S+ (.*)/)[1]],["IP address",e.ip]];M(T,X("Warning"),u.create("p").text("The website and/or device showing this QR code is currently not linked to your wallet."),u.create("p").className("_app_mt16").text("1. Make sure that the page displaying this QR code is "),u.create("p").className("_app_info").text("filesign.carmentis.local"),u.create("p").text("2. Review the connection information below:"),Z(n),q("agree","Everything looks OK.",(e=>u.get("#_app_ok").disabled(!e))),u.create("button","_app_ok").text("Confirm").click((async function(){await e.accept()})).disabled(!0),u.create("button").text("Cancel").click((async function(){await e.reject(),T()})))}(t):ne()}(a)}),250)}),500)}async function E(e){switch(console.log("processClientRequest",e),await new Promise((function(e,t){!function t(){b&&b.seed?e():(console.log("wallet locked"),setTimeout(t,100))}()})),console.log("wallet unlocked"),e.type){case"signIn":!async function(e){let t=await G(b.currentAccount);M(null,X("Sign In Request"),u.create("p").text("Would you like to sign in to the Carmentis workspace?"),u.create("button").text("Confirm").click((function(){e.answer({success:!0,data:{pubKey:ae(t)}}),T()})),u.create("button").text("Cancel").click((function(){e.answer({success:!1}),T()})))}(e);break;case"authentication":!async function(e){let t=b.accounts[b.currentAccount].userData.emailProof;M(null,X("Authentication Request"),u.create("p").html(`Do you confirm your authentication as <b>${t.email}</b>?`),u.create("button").text("Confirm").click((function(){e.answer({success:!0,proof:t}),T()})),u.create("button").text("Cancel").click((function(){e.answer({success:!1}),T()})))}(e);break;case"eventApproval":!async function(e){let[t,a]=e.data.id.split("-"),n=await Carmentis.derivePepperFromSeed(b.seed,b.currentAccount+1),c=await Carmentis.deriveUserPrivateKey(n,(i=t,new Uint8Array("string"==typeof i&&i.match(/^([\da-f]{2})*$/gi)?i.match(/../g).map((e=>parseInt(e,16))):[]))),r=await Carmentis.getPublicKey(c);var i;await e.answer({message:"walletHandshake",recordId:a,publicKey:ae(r)})}(e)}}async function I(e){"blockData"===e.type&&async function(e){y=await Carmentis.prepareApproval(e.data.applicationId,e.data.flowId,new Uint8Array(e.data.blockData)),O(e)}(e)}async function O(e){M(null,X("Approval"),u.create("div","_app_event_status"),u.create("hr"),u.create("p","_app_event_summary"),u.create("button").className("_app_button").html('<i class="bi bi-search"></i> See details').click((function(){Y(e,h.record,h.appDef.field)})),q("_app_agree","I agree.",(e=>u.get("#_app_confirm").disabled(!e))),u.create("button","_app_confirm").className("_app_button_small").text("Confirm").click((async function(){ce(),console.log("confirm",e),await e.answer({message:"confirmRecord",recordId:e.data.recordId}),await re(),e.clientAnswer({success:!0,recordId:e.data.recordId}),T()})).disabled(!0),u.create("button").className("_app_button_small").text("Cancel").click((function(){e.clientAnswer({success:!1}),T()})),u.create("div").style({position:"absolute",bottom:"10px"}).append(u.create("hr"),u.create("button").className("_app_button").html('<i class="bi bi-clock-history"></i> See history').click((t=>K(e))))),await ie(y.flowObject.chain.microBlock.length)}async function Y(e,t,a,n=["root"],c=[]){let r=[];Object.keys(t).forEach((i=>{let s=t[i],o=a.find((e=>e.name==i));if(o.flag&l.DATA.ARRAY)r.push({name:i,def:o,value:s,bg:"primary",label:"open",click:e=>e});else if(o.flag&l.DATA.STRUCT)r.push({name:i,def:o,bg:"primary",label:"open",click:r=>Y(e,s,h.appDef.structure[o.id].property,[...n,i],[...c,{node:t,fieldDef:a}])});else{let e,t;o.flag&l.DATA.PUBLIC?(e="success",t="public"):null===s?(e="danger",t="encrypted"):(e="success",t="decrypted"),r.push({name:i,def:o,value:s,bg:e,label:t,click:e=>e})}})),M(null,X("Event details"),u.create("p").className("_app_center").text(n.join(".")),...r.map((e=>u.create("p").append(u.create("b").text(e.name),u.create("span").style({float:"right",width:"80px",height:"19px",marginTop:"2px"}).className(`badge availability-badge rounded-pill bg-${e.bg}`).text(e.label).click(e.click),u.create("br"),...function(e){if(null===e.value)return["undisclosed"];if(e.def.flag&l.DATA.ARRAY)return[`array of ${e.value.length} entries`];if(e.def.flag&l.DATA.STRUCT)return["structure"];switch(e.def.id){case l.DATA.T_AMOUNT:return[e.value.amount+" "+e.value.currency];case l.DATA.T_FILE:return['"'+e.value.name+'"',"Size: "+d.formatNumber(e.value.size,{sep:","})+" bytes","CRCR32: "+e.value.crc32,"SHA256: "+e.value.sha256.slice(0,16)+"⋯"+e.value.sha256.slice(-4)];default:return['"'+e.value+'"']}}(e).map((e=>u.create("div").style({fontFamily:"monospace"}).text(e)))))),...c.length?[u.create("button").className("_app_button").text("Up").click((function(){let t=c.pop();Y(e,t.node,t.fieldDef,n.slice(0,-1),c)}))]:[],u.create("button").className("_app_button").text("Back to event summary").click((t=>O(e))))}async function K(e){let t=y.flowObject.chain.microBlock.length;function a(){Y(e,h.record,h.appDef.field)}M(null,X("Flow history"),...t>1?[...Array(t-1)].map(((t,n)=>u.create("button").className("_app_item_btn").text("Event "+(n+1)).click((t=>async function(t){M(null,X("Event "+t),u.create("div","_app_event_status"),u.create("hr"),u.create("p","_app_event_summary"),u.create("button").className("_app_button").html('<i class="bi bi-search"></i> See details').click(a),u.create("div").style({position:"absolute",bottom:"10px"}).append(u.create("hr"),u.create("button").className("_app_button").html("Close").click((t=>K(e))))),await ie(t)}(n+1))))):[u.create("p").text("This is the first event in this flow.")],u.create("button").className("_app_button").text("Back to approval").click((t=>O(e))))}function F(){M(T,X("Your accounts"),...b.accounts.map(((e,t)=>u.create("div").append(u.create("button").className("_app_item_btn").append(...t==b.currentAccount?[u.create("span").className("_app_btn_check").append(V("check-circle-fill"))]:[],u.create("span").text(`#${t+1} - ${e.name}`)).click((e=>S(t)))))),u.create("hr"),u.create("button").html('<i class="bi bi-check2-circle"></i> Change active account').click($),u.create("button").html('<i class="bi bi-plus-circle"></i> Create a new account').click((e=>P(b.accounts.length,F))),u.create("button").text("Close").click(T))}function $(){let e=b.currentAccount;M(F,X("Select active account"),...b.accounts.map(((t,a)=>u.create("div").append(u.create("input","_app_acct"+a).setAttribute("type","radio").setAttribute("name","accounts").checked(a==e).click((t=>e=a)),u.create("label").setAttribute("for","_app_acct"+a).text(`#${a+1} - ${t.name}`)))),u.create("button").className("_app_mt16").text("Confirm").click((function(){b.currentAccount=e,F()})))}function j(){M(T,X("Parameters"),u.create("button").text("Show the passphrase").click((async function(){b.wordList=await Carmentis.getWordListFromSeed(b.seed),C(j,!0,!1)})),u.create("button").className("_app_bg_red").text("Reset your wallet").click((async function(){await p("accounts"),await p("seed"),v()})))}function q(e,t,a,n){let c=u.create("div").className("_app_checkbox").append(u.create("label").append(u.create("input",e).setAttribute("type","checkbox").checked(n),u.create("span").html(t)));return a&&c.event("change",(e=>a(e.target.checked))),c}function M(e,...t){b.backCallback=e,e&&t.push(u.create("div").className("_app_back").append(V("arrow-left-short").click(e))),u.get("#_app_content").setContent(...t)}function W(...e){u.get("#_app_content").append(...e)}function B(e){e.preventDefault(),e.stopPropagation(),u.get("#_app_over").setContent(X("Security"),J("Your data"),u.create("p").text("With Carmentis, and unlike what happens in a classic centralized system, your data is stored in an encrypted blockchain. You, and only you, have the ability to access your data using your private key."),J("Your passphrase"),u.create("p").text("Your private key is derived from a passphrase. At no time does Carmentis have access to your passphrase. It is your responsibility to store it securely."),J("Your password"),u.create("p").text("On a given device, your key is itself encrypted using a password for easier and faster access. At no time does Carmentis have access to your password. To renew it, you must provide either the previous password (on a specific device) or the original passphrase (on any device)."),u.create("button").text("OK").click((e=>u.get("#_app_over").hide()))).show()}function z(e){return u.get("#_app_"+e).el.value.trim()}function Q(e){let t=b.accounts[e]=b.accounts[e]||{name:""};return t.userData=t.userData||{},t.userData.firstname=t.userData.firstname||"",t.userData.lastname=t.userData.lastname||"",t.userData.email=t.userData.email||"",b.accounts[e]}async function H(){await async function(e,t){let n=a.encode(JSON.stringify(t));return await o("accounts",n)}(0,b.accounts)}function X(e){return u.create("div").className("_app_title").text(e)}function J(e){return u.create("div").className("_app_section").html(e)}function V(e){return u.create("i").className("bi bi-"+e)}function Z(e){return u.create("table").className("_app_info_table").append(...e.map((([e,t])=>u.create("tr").append(u.create("td").text(e),u.create("th").text(t)))))}async function G(e){let t=await Carmentis.derivePepperFromSeed(b.seed,e+1),a=await Carmentis.deriveAuthenticationPrivateKey(t);return await Carmentis.getPublicKey(a)}function ee(e){let t=ae(e);return u.create("p").className("_app_key").html(t.slice(0,t.length/2)+"<br>"+t.slice(t.length/2))}function te(e){return u.create("p").className("_app_center _app_mt16").append(u.create("a").setAttribute("href","#").html('<i class="bi bi-copy"></i> Copy this key').click((t=>{t.preventDefault(),navigator.clipboard.writeText(ae(e))})))}function ae(e){return[...e].map((e=>e.toString(16).toUpperCase().padStart(2,"0"))).join("")}function ne(e=T){M(null,u.create("div").className("_app_notif_icon _app_error_bg").append(V("x"))),setTimeout(e,1e3)}function ce(){b.spinnerTs=+new Date,M(null,u.create("div").className("spinner-border text-primary _app_spinner"))}async function re(){let e=Math.max(0,b.spinnerTs+500-new Date);return await new Promise((function(t){setTimeout(t,e)}))}async function ie(e){let t=[];h=await Carmentis.processRecord(y,e,(function(e){t.push(u.textNode(e))}),(function(e,a,n){t.push(u.create("span").className("_app_msg_field"+(null===n?" undisclosed":"")).setAttribute("data-bs-toggle","tooltip").setAttribute("title",e).text(function(e,t){if(null===t)return"undisclosed";if(e.flag&l.DATA.ARRAY)return`array of ${t.length} entries`;if(e.flag&l.DATA.STRUCT)return"structure";switch(e.id){case l.DATA.T_AMOUNT:return t.amount+" "+t.currency;case l.DATA.T_FILE:return t.name;default:return t}}(a,n)))})),console.log("processedRecord",h),function(e){y.flowObject.chain;let t=e.microBlock,a=new Date(1e3*t.ts),n=a.getUTCDate(),c=a.toLocaleString("en-US",{month:"long",timeZone:"UTC"})+" "+n+(["","st","nd","rd"][n%10]||"th")+", "+a.getUTCFullYear(),r=a.getUTCHours().toString().padStart(2,"0")+":"+a.getUTCMinutes().toString().padStart(2,"0")+":"+a.getUTCSeconds().toString().padStart(2,"0")+" (UTC)",i=[["Application",y.appDescription.name+" | version "+y.flowObject.appVersion(t.nonce)],["Date",c],["Time",r],["Status",t.pending?"Awaiting user approval":"Anchored"]];u.get("#_app_event_status").setContent(Z(i))}(h.data),u.get("#_app_event_summary").setContent(...t),document.querySelectorAll('[data-bs-toggle="tooltip"]').forEach((e=>new bootstrap.Tooltip(e)))}return e.initialize=function(e={}){Carmentis.registerNodeEndpoint("https://node.testapps.carmentis.io"),Carmentis.registerDataEndpoint("https://data.testapps.carmentis.io"),window.addEventListener("load",(t=>function(e){let t=u.elementToObject(document.body),a="bottomLeft"==e.position?"bottom_left":"bottom_right",n=document.createElement("link");n.rel="stylesheet",n.type="text/css",n.href="assets/debug-app/css/style.css",document.getElementsByTagName("head")[0].appendChild(n),t.append(u.create("div","_app_icon").className("_app_icon_"+a).append(u.create("div","_app_open").append(V("phone"))).click((function(){c^=1,u.get("#_app_wrapper").show(c),c&&!r&&(r=!0,v())}))),t.append(u.create("div","_app_wrapper").append(u.create("div","_app_header").append(u.create("div","_app_user").append(V("person-circle"),u.create("span")).click((function(){w(f^=1),v()})),u.create("div","_app_restart").append(V("arrow-clockwise")).click(v),u.create("div","_app_close").append(V("x-circle")).click((function(){c=0,u.get("#_app_wrapper").hide()}))),u.create("div","_app_screen").append(u.create("div","_app_over"),u.create("div","_app_content")),u.create("div","_app_footer").append(u.create("div","_app_back").append(V("chevron-left")).click((e=>b.backCallback&&b.backCallback())))));let c=0,r=!1,i=u.get("#_app_wrapper"),s={move:!1};u.get("#_app_header").event("mousedown",(function(e){"_app_header"==e.target.id&&(s.move=!0,document.body.classList.add("no-select"),s.initX=e.offsetX,s.initY=e.offsetY)})),u.elementToObject(document).event("mousemove",(function(e){s.move&&i.style({left:Math.min(Math.max(0,e.clientX-s.initX),window.innerWidth-355)+"px",top:Math.min(Math.max(0,e.clientY-s.initY),window.innerHeight-711)+"px"})})),i.event("mouseup",(function(){s.move=!1,document.body.classList.remove("no-select")})),w(0)}(e))),Carmentis.wallet.setRequestCallback(E,I),Carmentis.wallet.attemptToReconnect()},e}({});